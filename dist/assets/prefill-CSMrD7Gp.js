import{l as k}from"./store-BSL5kiAv.js";import{bq as B,br as C,bs as h,bt as O,bu as $,bv as w,bw as X,bx as _,by as G,bz as V,bA as W,bB as q}from"./index-2ctv-q5D.js";function K(e){if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;let r=String(e).trim();if(!r)return null;r=r.replace(/\s+/g,""),r=r.replace(/[€$£]/g,"");const s=r.lastIndexOf(","),u=r.lastIndexOf(".");let n=r;if(s>-1&&u>-1?s>u?n=n.replace(/\./g,"").replace(/,/g,"."):n=n.replace(/,/g,""):s>-1?n=n.replace(/\./g,"").replace(/,/g,"."):u>-1&&(n=n.replace(/,/g,"")),!/^[-+]?\d+(?:\.\d+)?$/.test(n))return null;const t=Number(n);return Number.isFinite(t)?t:null}function E(e,r=2,s={}){const u=Number(e);return Number.isFinite(u)?u.toLocaleString("de-DE",{minimumFractionDigits:r,maximumFractionDigits:r,...s}):""}function Z(e){const r=K(e);if(r==null)return null;const s=Math.round(r*100)/100;return Number.isFinite(s)?s:null}function ee(e,r=2){return E(e,r,{useGrouping:!1})}function te(e,r=2){return E(e,r,{useGrouping:!0})}const Y=[{label:"Deposit",percent:30,triggerEvent:"ORDER_DATE",offsetDays:0},{label:"Balance",percent:70,triggerEvent:"ETD",offsetDays:0}];function j(e){return String(e||"").trim().toUpperCase()||"EXW"}function H(e){return String(e||"").trim().toUpperCase()||"SEA"}function R(e,r){return e==null||e===""?r:e}function l(e){return e==null||!Number.isFinite(e)?null:e}function i(e){return e?e==="product"?"Produkt":e==="productSupplier"?"SKU↔Supplier":e==="supplier"?"Supplier Default":e==="settings"?"Settings Default":e==="computed"?"Berechnet":e:null}function g(e,r){const s=i(r);return!s||r==="product"?null:`${e}: ${s}`}function re(e,r={},s={}){var T,v;const u=s.state||k(),n=u.settings||{},{product:t,supplier:a,supplierId:D,productSupplier:o}=B(u,e,r.supplierId),y=H(R(r.transportMode,C({product:t,transportMode:r.transportMode}))),S=j(R(r.incoterm,(t==null?void 0:t.defaultIncoterm)||(a==null?void 0:a.incotermDefault)||"EXW")),L=(v=(T=t==null?void 0:t.template)==null?void 0:T.fields)!=null&&v.transportMode||t!=null&&t.defaultTransportMode?"product":"settings",M=t!=null&&t.defaultIncoterm?"product":a!=null&&a.incotermDefault?"supplier":"settings",b=h({product:t,productSupplier:o,supplier:a,settings:n}),c=O(t,n),p=$({product:t,productSupplier:o,supplier:a,settings:n}),f=w({settings:n,product:t,transportMode:y}),d=X({product:t,productSupplier:o}),m=_({product:t,productSupplier:o,fxRate:c.value,unitPriceUsd:d.value}),F=G({product:t,settings:n}),U=V({product:t,settings:n}),x=W({product:t,settings:n}),P=q({productSupplier:o,supplier:a}),N=[g("Production Lead Time",p.source),g("Transit Lead Time",f.source),g("FX",c.source),g("Logistik / Stk. (EUR)",m.source)].filter(Boolean),I=P.value||Y,z=P.source||"settings",A=t!=null&&t.supplierId?"product":o!=null&&o.supplierId?"productSupplier":D?"history":null;return{sku:(t==null?void 0:t.sku)||e||"",mode:r.mode||"FO",supplierId:D||"",transportMode:y,incoterm:S,currency:b,unitPrice:l(d.value),logisticsPerUnitEur:l(m.value),logisticsMissingFields:m.missingFields||[],dutyRatePct:l(F),eustRatePct:l(U),fxRate:l(c.value),ddp:x,productionLeadTimeDays:l(p.value),logisticsLeadTimeDays:l(f.value),bufferDays:l(n.defaultBufferDays??0),paymentTerms:I,sources:{unitPrice:i(d.source),logisticsPerUnitEur:i(m.source),productionLeadTimeDays:i(p.source),logisticsLeadTimeDays:i(f.source),transportMode:i(L),incoterm:i(M),fxRate:i(c.source),dutyRatePct:i((t==null?void 0:t.dutyRatePct)!=null?"product":(n==null?void 0:n.dutyRatePct)!=null?"settings":null),eustRatePct:i((t==null?void 0:t.eustRatePct)!=null?"product":(n==null?void 0:n.eustRatePct)!=null?"settings":null),paymentTerms:i(z),supplier:i(A)},resolvedUsingDefaults:N,resolvedValues:{fxRate:c.value,productionLeadTimeDays:p.value,logisticsLeadTimeDays:f.value,logisticsPerUnitEur:m.value,unitPrice:d.value,currency:b}}}export{Y as D,Z as a,re as b,E as c,ee as d,te as f,K as p};
