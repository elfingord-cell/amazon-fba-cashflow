import{p as M}from"./index-DN7VFcDZ.js";import{g as j,b as W,c as Y,f as $}from"./foSuggestion-Ck1952gl.js";const w=["DRAFT","ACTIVE","CONVERTED","ARCHIVED"],G={PLANNED:"ACTIVE",CANCELLED:"ARCHIVED"},yt=["SEA","RAIL","AIR"],mt=["EXW","DDP","FCA"],H=["ORDER_DATE","PRODUCTION_END","ETD","ETA","DELIVERY"],K=["EUR","USD","CNY"],Et=["ORDER_DATE","PROD_DONE","ETD","ETA"];function z(t,e="DRAFT"){const r=String(t||"").trim().toUpperCase();return r?w.includes(r)?r:G[r]||e:e}function q(t){const e=z(t);return e==="DRAFT"||e==="ACTIVE"}function ht(t){return q(t)}function X(t,e){const r=Array.isArray(e)?e:[];if(!r.length)return t;const o=new Map(r.map(s=>[String((s==null?void 0:s.id)||""),s]));return t.map(s=>{const n=o.get(String(s.id||""));return n?{...s,dueDate:n.dueDateManuallySet?String(n.dueDate||s.dueDate||""):s.dueDate,dueDateManuallySet:n.dueDateManuallySet===!0?!0:s.dueDateManuallySet,isOverridden:n.isOverridden===!0?!0:s.isOverridden}:s})}function h(t,e=0){const r=M(t);return Number.isFinite(r)?Number(r):e}function p(t){const e=M(t);if(!Number.isFinite(e))return null;const r=Number(e);return r<=0?null:r}function i(t,e=0){return Math.max(0,h(t,e))}function R(t){return t==null?null:String(t).trim()||null}function E(t){if(!t)return null;const[e,r,o]=String(t).split("-").map(Number);if(!e||!r||!o)return null;const s=new Date(Date.UTC(e,r-1,o));return Number.isNaN(s.getTime())?null:s}function m(t){return!(t instanceof Date)||Number.isNaN(t.getTime())?null:t.toISOString().slice(0,10)}function S(t,e){const r=new Date(t.getTime());return r.setUTCDate(r.getUTCDate()+Number(e||0)),r}function J(t,e){const r=new Date(t.getTime());return r.setUTCMonth(r.getUTCMonth()+Number(e||0)),r}function C(t){return t==="PRODUCTION_END"?"PROD_DONE":t==="DELIVERY"?"ETA":t}function B(t){return $.monthKey(t)}function A(t){const e=String(t||"").trim().toUpperCase();return H.includes(e)?e:"ORDER_DATE"}function U(t,e="EUR"){const r=String(t||e).trim().toUpperCase();return K.includes(r)?r:e}function F(){return[{label:"Deposit",percent:30,triggerEvent:"ORDER_DATE",offsetDays:0,offsetMonths:0},{label:"Balance",percent:70,triggerEvent:"ETD",offsetDays:0,offsetMonths:0}]}function Q(t,e=0){const r=M(t);return Number.isFinite(r)?Math.round(Number(r)):e}function Z(t){const e={freight:{triggerEvent:"ETD",offsetDays:0},duty:{triggerEvent:"ETA",offsetDays:0},eust:{triggerEvent:"ETA",offsetDays:0},eustRefund:{triggerEvent:"ETA",offsetDays:0}},r=t&&typeof t=="object"?t:{},o=r.fo&&typeof r.fo=="object"?r.fo:{},s=(n,c)=>{const a=o[n]&&typeof o[n]=="object"?o[n]:{};return{triggerEvent:A(a.triggerEvent??c.triggerEvent),offsetDays:Q(a.offsetDays,c.offsetDays)}};return{freight:s("freight",e.freight),duty:s("duty",e.duty),eust:s("eust",e.eust),eustRefund:s("eustRefund",e.eustRefund)}}function tt(t){const e={ORDER_DATE:E(t.orderDate),PRODUCTION_END:E(t.productionEndDate),ETD:E(t.etdDate),ETA:E(t.etaDate),DELIVERY:E(t.deliveryDate)};return!e.ETD&&e.ETA&&Number.isFinite(Number(t.logisticsLeadTimeDays))&&(e.ETD=S(e.ETA,-Number(t.logisticsLeadTimeDays||0))),e}function N(t,e,r,o){const s=o[t]||null;if(!s)return null;let n=S(s,Number(e||0));return r&&(n=J(n,Number(r||0))),m(n)}function T(t){return`${t}-${Math.random().toString(36).slice(2,9)}`}function P(){return new Date().toISOString()}function et(t){const e=new Date,r=t instanceof Date?t:typeof t=="string"||typeof t=="number"?new Date(t):null;return r instanceof Date&&!Number.isNaN(r.getTime())?String(r.getFullYear()).slice(-2):String(e.getFullYear()).slice(-2)}function rt(t,e){const r=String(t||"").trim().toUpperCase();if(!r)return null;const o=r.replace(/[\s_-]+/g,""),s=o.startsWith("FO")?o.slice(2):o;if(!/^\d+$/.test(s)||!s.startsWith(e))return null;const n=s.slice(e.length);if(!n)return null;const c=Number(n);return!Number.isFinite(c)||c<=0?null:c}function St(t,e){const r=et(e);let o=0;(t||[]).forEach(c=>{const a=c||{};[a.foNo,a.foNumber,a.id].forEach(u=>{const f=rt(u,r);f!=null&&f>o&&(o=f)})});const s=String(o+1).padStart(3,"0"),n=`${r}${s}`;return{foNo:n,foNumber:`FO${n}`}}function b(t,e,r){const o=h(t,0);if(String(e||"EUR").toUpperCase()==="EUR")return o;const n=i(r,0);return n?o/n:o}function pt(t){const e=E(t.targetDeliveryDate),r=i(t.productionLeadTimeDays,0),o=i(t.logisticsLeadTimeDays,0),s=i(t.bufferDays,0);if(!e||r<=0)return{orderDate:null,productionEndDate:null,etdDate:null,etaDate:null,deliveryDate:e?m(e):null,logisticsLeadTimeDays:o};const n=S(e,-(r+o+s)),c=S(n,r),a=c,u=S(a,o);return{orderDate:m(n),productionEndDate:m(c),etdDate:m(a),etaDate:m(u),deliveryDate:m(e),logisticsLeadTimeDays:o}}function nt(t){const e=E(t.orderDate),r=i(t.productionLeadTimeDays,0),o=i(t.logisticsLeadTimeDays,0),s=i(t.bufferDays,0);if(!e)return{orderDate:null,productionEndDate:null,etdDate:null,etaDate:null,deliveryDate:t.deliveryDate?String(t.deliveryDate):null,logisticsLeadTimeDays:o};const n=S(e,r+s),c=n,a=S(c,o);return{orderDate:m(e),productionEndDate:m(n),etdDate:m(c),etaDate:m(a),deliveryDate:t.deliveryDate?String(t.deliveryDate):null,logisticsLeadTimeDays:o}}function k(t){const e=t||{},r=String(e.sku||"").trim();if(!r)return null;const o=Math.max(0,Math.round(h(e.units,0))),s=i(e.unitCostUsd,0),n=i(e.unitExtraUsd,0),c=i(e.extraFlatUsd,0),a=Math.max(0,Math.round(p(e.prodDays)??i(e.productionLeadTimeDays,0))),u=Math.max(0,Math.round(p(e.transitDays)??i(e.logisticsLeadTimeDays,0))),f=i(e.freightEur,0);return{id:String(e.id||T("poi")),sku:r,units:o,unitCostUsd:s,unitExtraUsd:n,extraFlatUsd:c,prodDays:a,transitDays:u,freightEur:f}}function st(t,e){const r=Array.isArray(t)?t.map(k).filter(Boolean):[];if(r.length)return r;const o=String((e==null?void 0:e.sku)||"").trim();if(!o)return[];const s=k({id:String((e==null?void 0:e.id)||T("poi")),sku:o,units:e==null?void 0:e.units,unitCostUsd:e==null?void 0:e.unitCostUsd,unitExtraUsd:e==null?void 0:e.unitExtraUsd,extraFlatUsd:e==null?void 0:e.extraFlatUsd,prodDays:e==null?void 0:e.prodDays,transitDays:e==null?void 0:e.transitDays,freightEur:e==null?void 0:e.freightEur});return s?[s]:[]}function vt(t){var g;const e=st(t.items,t.fallback);let r=0,o=0,s=0,n=0,c=0;const a=E(t.orderDate);let u=null,f=null;e.forEach(l=>{const d=l.units*(l.unitCostUsd+l.unitExtraUsd)+l.extraFlatUsd;if(r+=d,o+=l.freightEur,s+=l.units,n=Math.max(n,l.prodDays),c=Math.max(c,l.transitDays),a){const D=S(a,l.prodDays+l.transitDays);(!u||D<u)&&(u=D),(!f||D>f)&&(f=D)}});const y=nt({orderDate:t.orderDate,productionLeadTimeDays:n,logisticsLeadTimeDays:c,bufferDays:0});return{items:e,goodsUsd:r,goodsEur:b(r,"USD",t.fxRate),freightEur:o,units:s,prodDays:n,transitDays:c,firstSku:((g=e[0])==null?void 0:g.sku)||"",minEtaDate:m(u),maxEtaDate:m(f),schedule:y}}function Mt(t){return at([],t).map((r,o)=>({id:String(r.id||`ms-${o+1}-${Math.random().toString(36).slice(2,8)}`),label:String(r.label||"Milestone"),percent:i(r.percent,0),anchor:C(A(r.triggerEvent)),lagDays:h(r.offsetDays,0)}))}function ot(t){const e=i(t.units,0),r=i(t.unitPrice,0),o=e*r,s=b(o,t.currency,t.fxRate),n=i(t.freight,0),c=b(n,t.freightCurrency,t.fxRate),a=i(t.dutyRatePct,0),u=i(t.eustRatePct,0),f=s*(a/100),y=(s+f+c)*(u/100),g=s+c+f+y;return{supplierCost:o,supplierCostEur:s,freightAmount:n,freightEur:c,dutyAmountEur:f,eustAmountEur:y,landedCostEur:g}}function at(t,e){const r=Array.isArray(t)?t.filter(s=>String((s==null?void 0:s.category)||"supplier")==="supplier"):[];if(r.length)return r.map(s=>({id:s.id?String(s.id):void 0,label:String(s.label||"Milestone"),percent:i(s.percent,0),triggerEvent:A(s.triggerEvent),offsetDays:h(s.offsetDays,0),offsetMonths:h(s.offsetMonths,0)}));const o=Array.isArray(e==null?void 0:e.paymentTermsDefault)?e==null?void 0:e.paymentTermsDefault:[];return o.length?o.map(s=>({id:s.id?String(s.id):void 0,label:String(s.label||"Milestone"),percent:i(s.percent,0),triggerEvent:A(s.triggerEvent),offsetDays:h(s.offsetDays,0),offsetMonths:h(s.offsetMonths,0)})):F()}function it(t){const e=ot(t),r=tt(t.schedule),o=i(t.unitPrice,0)*i(t.units,0),s=(t.supplierTerms||[]).map((g,l)=>{const d=A(g.triggerEvent),D=h(g.offsetDays,0),v=h(g.offsetMonths,0);return{id:g.id||`supplier-${l}`,label:String(g.label||"Milestone"),percent:i(g.percent,0),amount:o*(i(g.percent,0)/100),currency:U(t.currency,"EUR"),triggerEvent:d,offsetDays:D,offsetMonths:v,dueDate:N(d,D,v,r),isOverridden:!1,dueDateManuallySet:!1,category:"supplier"}}),n=String(t.incoterm||"EXW").toUpperCase(),c=Math.max(0,Math.round(i(t.vatRefundLagMonths,2))),a=Z(t.paymentDueDefaults),u=[...s];n!=="DDP"&&e.freightAmount>0&&u.push({id:"auto-freight",label:"Fracht",percent:0,amount:e.freightAmount,currency:U(t.freightCurrency,"EUR"),triggerEvent:a.freight.triggerEvent,offsetDays:a.freight.offsetDays,offsetMonths:0,dueDate:N(a.freight.triggerEvent,a.freight.offsetDays,0,r),category:"freight",isOverridden:!1,dueDateManuallySet:!1});const f=i(t.dutyRatePct,0);n!=="DDP"&&f>0&&u.push({id:"auto-duty",label:"Duty",percent:f,amount:e.dutyAmountEur,currency:"EUR",triggerEvent:a.duty.triggerEvent,offsetDays:a.duty.offsetDays,offsetMonths:0,dueDate:N(a.duty.triggerEvent,a.duty.offsetDays,0,r),category:"duty",isOverridden:!1,dueDateManuallySet:!1});const y=i(t.eustRatePct,0);return n!=="DDP"&&y>0&&(u.push({id:"auto-eust",label:"EUSt",percent:y,amount:e.eustAmountEur,currency:"EUR",triggerEvent:a.eust.triggerEvent,offsetDays:a.eust.offsetDays,offsetMonths:0,dueDate:N(a.eust.triggerEvent,a.eust.offsetDays,0,r),category:"eust",isOverridden:!1,dueDateManuallySet:!1}),u.push({id:"auto-eust-refund",label:"EUSt Erstattung",percent:y,amount:-e.eustAmountEur,currency:"EUR",triggerEvent:a.eustRefund.triggerEvent,offsetDays:a.eustRefund.offsetDays,offsetMonths:c,dueDate:N(a.eustRefund.triggerEvent,a.eustRefund.offsetDays,c,r),category:"eust_refund",isOverridden:!1,dueDateManuallySet:!1})),X(u,t.existingPayments)}function Tt(t){return Math.round((t||[]).reduce((e,r)=>e+i(r.percent,0),0)*100)/100}function At(t){const e=P(),r=t.values||{},o=t.schedule,s=t.supplierTerms||[],n=t.existing||null,c=it({supplierTerms:s,schedule:o,unitPrice:r.unitPrice,units:r.units,currency:r.currency,freight:r.freight,freightCurrency:r.freightCurrency,dutyRatePct:r.dutyRatePct,eustRatePct:r.eustRatePct,fxRate:r.fxRate,incoterm:r.incoterm,vatRefundLagMonths:t.vatRefundLagMonths,paymentDueDefaults:t.paymentDueDefaults,existingPayments:n==null?void 0:n.payments});return{...n||{},id:String(r.id||(n==null?void 0:n.id)||T("fo")),sku:String(r.sku||""),supplierId:String(r.supplierId||""),targetDeliveryDate:r.targetDeliveryDate?String(r.targetDeliveryDate):null,units:i(r.units,0),transportMode:String(r.transportMode||"SEA").toUpperCase(),incoterm:String(r.incoterm||"EXW").toUpperCase(),unitPrice:i(r.unitPrice,0),unitPriceIsOverridden:!!r.unitPriceIsOverridden,currency:U(r.currency,"EUR"),freight:i(r.freight,0),freightCurrency:U(r.freightCurrency,"EUR"),dutyRatePct:i(r.dutyRatePct,0),eustRatePct:i(r.eustRatePct,0),fxRate:i(r.fxRate,0),productionLeadTimeDays:i(r.productionLeadTimeDays,0),productionLeadTimeDaysManual:i(r.productionLeadTimeDaysManual,0),productionLeadTimeSource:r.productionLeadTimeSource||null,logisticsLeadTimeDays:i(r.logisticsLeadTimeDays,0),bufferDays:i(r.bufferDays,0),orderDate:o.orderDate,productionEndDate:o.productionEndDate,etdDate:o.etdDate,etaDate:o.etaDate,deliveryDate:o.deliveryDate,payments:c,status:z(r.status,"DRAFT"),convertedPoId:r.convertedPoId||(n==null?void 0:n.convertedPoId)||null,convertedPoNo:r.convertedPoNo||(n==null?void 0:n.convertedPoNo)||null,forecastBasisVersionId:R(r.forecastBasisVersionId??(n==null?void 0:n.forecastBasisVersionId)),forecastBasisVersionName:R(r.forecastBasisVersionName??(n==null?void 0:n.forecastBasisVersionName)),forecastBasisSetAt:R(r.forecastBasisSetAt??(n==null?void 0:n.forecastBasisSetAt)),forecastConflictState:R(r.forecastConflictState??(n==null?void 0:n.forecastConflictState)),supersedesFoId:R(r.supersedesFoId??(n==null?void 0:n.supersedesFoId)),supersededByFoId:R(r.supersededByFoId??(n==null?void 0:n.supersededByFoId)),createdAt:(n==null?void 0:n.createdAt)||e,updatedAt:e}}function Rt(t){const e=t.fo||{},r=String(t.poNumber||"").trim(),o=i(e.fxRate,0),s=b(e.freight,e.freightCurrency,o),n=i(e.productionLeadTimeDays,0),c=i(e.bufferDays,0),a=i(e.logisticsLeadTimeDays,0),u=n+c,f=Array.isArray(e.payments)?e.payments.filter(D=>String((D==null?void 0:D.category)||"")==="supplier"):[],y=f.length?f:F(),g=t.orderDateOverride||e.orderDate||null,l=E(g)?String(g):null;return{id:T("po"),poNo:r,sku:String(e.sku||""),supplierId:String(e.supplierId||""),units:i(e.units,0),unitCostUsd:i(e.unitPrice,0),unitExtraUsd:0,extraFlatUsd:0,orderDate:l,prodDays:u,transitDays:a,transport:String(e.transportMode||"SEA").toLowerCase(),freightEur:s,dutyRatePct:i(e.dutyRatePct,0),eustRatePct:i(e.eustRatePct,0),fxOverride:o||null,ddp:String(e.incoterm||"").toUpperCase()==="DDP",milestones:y.map(D=>({id:String(D.id||T("ms")),label:String(D.label||"Milestone"),percent:i(D.percent,0),anchor:C(A(D.triggerEvent)),lagDays:h(D.offsetDays,0)})),sourceFoIds:[String(e.id||"")].filter(Boolean),createdAt:P(),updatedAt:P()}}function ut(t){const e=E(t.orderDateOverride);if(e)return m(e);const r=E(t.targetDeliveryDate);if(r){const s=Math.max(0,Math.round(Number(t.maxProdDays||0)+Number(t.maxTransitDays||0)));return m(S(r,-s))}const o=E(t.fallbackOrderDate);return o?m(o):null}function ct(t){const e=i(t.productionLeadTimeDays,0),r=i(t.bufferDays,0);return{id:T("poi"),sku:String(t.sku||"").trim(),units:i(t.units,0),unitCostUsd:i(t.unitPrice,0),unitExtraUsd:0,extraFlatUsd:0,prodDays:Math.max(0,Math.round(e+r)),transitDays:Math.max(0,Math.round(i(t.logisticsLeadTimeDays,0))),freightEur:b(t.freight,t.freightCurrency,t.fxRate)}}function Nt(t){const e=Array.isArray(t.fos)?t.fos.filter(Boolean):[];if(!e.length)throw new Error("Keine FOs fuer Merge vorhanden.");const r=e[0];if(Array.from(new Set(e.map(d=>String((d==null?void 0:d.supplierId)||"").trim()).filter(Boolean))).length>1)throw new Error("FO-Merge erlaubt nur einen gemeinsamen Lieferanten.");const s=String(t.poNumber||"").trim(),n=e.map(d=>ct(d)),c=n.reduce((d,D)=>Math.max(d,Number(D.prodDays||0)),0),a=n.reduce((d,D)=>Math.max(d,Number(D.transitDays||0)),0),u=ut({orderDateOverride:t.orderDateOverride,targetDeliveryDate:t.targetDeliveryDate,maxProdDays:c,maxTransitDays:a,fallbackOrderDate:String(r.orderDate||"")}),f=Array.isArray(r.payments)?r.payments.filter(d=>String((d==null?void 0:d.category)||"")==="supplier"):[],y=f.length?f:F(),g=n.reduce((d,D)=>d+Number(D.units||0),0),l=n.reduce((d,D)=>d+Number(D.freightEur||0),0);return{id:T("po"),poNo:s,supplierId:String(r.supplierId||""),sku:String(r.sku||""),items:n,units:Math.max(0,Math.round(g)),unitCostUsd:i(r.unitPrice,0),unitExtraUsd:0,extraFlatUsd:0,orderDate:u,prodDays:c,transitDays:a,transport:String(r.transportMode||"SEA").toLowerCase(),freightEur:Math.max(0,Math.round(l*100)/100),dutyRatePct:i(r.dutyRatePct,0),eustRatePct:i(r.eustRatePct,0),fxOverride:i(r.fxRate,0)||null,ddp:String(r.incoterm||"").toUpperCase()==="DDP",etaManual:E(t.targetDeliveryDate)?String(t.targetDeliveryDate):null,milestones:y.map(d=>({id:String(d.id||T("ms")),label:String(d.label||"Milestone"),percent:i(d.percent,0),anchor:C(A(d.triggerEvent)),lagDays:h(d.offsetDays,0)})),sourceFoIds:e.map(d=>String(d.id||"")).filter(Boolean),createdAt:P(),updatedAt:P()}}function dt(t){var n,c;const e=((n=t==null?void 0:t.forecast)==null?void 0:n.forecastManual)||{},r=((c=t==null?void 0:t.forecast)==null?void 0:c.forecastImport)||{},o={},s=a=>{const u=String(a||"").trim();if(!u)return;o[u]||(o[u]={});const f=e[u]||{},y=r[u]||{};new Set([...Object.keys(y),...Object.keys(f)]).forEach(l=>{var v;const d=M(f[l]);if(Number.isFinite(d)){o[u][l]=Number(d);return}const D=M((v=y[l])==null?void 0:v.units);Number.isFinite(D)&&(o[u][l]=Number(D))})};return Object.keys(r).forEach(s),Object.keys(e).forEach(s),o}function ft(t){var o;const e={};return(((o=t==null?void 0:t.inventory)==null?void 0:o.snapshots)||[]).forEach(s=>{const n=String((s==null?void 0:s.month)||"");if(!n)return;(Array.isArray(s.items)?s.items:[]).forEach(a=>{const u=String((a==null?void 0:a.sku)||"").trim();if(!u)return;e[u]||(e[u]={});const f=M(a==null?void 0:a.amazonUnits),y=M(a==null?void 0:a.threePLUnits),g=M(a==null?void 0:a.units);if(Number.isFinite(f)||Number.isFinite(y)){const d=Number.isFinite(f)?Math.max(0,Number(f)):0,D=Number.isFinite(y)?Math.max(0,Number(y)):0;e[u][n]=d+D;return}e[u][n]=Number.isFinite(g)?Math.max(0,Number(g)):0})}),e}function V(t){const e=(t==null?void 0:t.arrivalDateDe)||(t==null?void 0:t.arrivalDate)||(t==null?void 0:t.etaDate)||(t==null?void 0:t.etaManual)||(t==null?void 0:t.eta);if(e)return E(e);const r=E(t==null?void 0:t.orderDate);if(!r)return null;const o=i((t==null?void 0:t.prodDays)??(t==null?void 0:t.productionLeadTimeDays),0),s=i((t==null?void 0:t.transitDays)??(t==null?void 0:t.logisticsLeadTimeDays),0);return S(r,o+s)}function _(t){if(Array.isArray(t==null?void 0:t.items)&&t.items.length>0)return t.items.map(r=>({sku:String((r==null?void 0:r.sku)||"").trim(),units:i(r==null?void 0:r.units,0)}));const e=String((t==null?void 0:t.sku)||"").trim();return e?[{sku:e,units:i(t==null?void 0:t.units,0)}]:[]}function Dt(t){const e={};let r=0;return(Array.isArray(t==null?void 0:t.pos)?t.pos:[]).forEach(n=>{if(n!=null&&n.archived)return;const c=V(n);if(!c){r+=1;return}const a=B(c);_(n).forEach(u=>{!u.sku||u.units<=0||(e[u.sku]||(e[u.sku]={}),e[u.sku][a]=(e[u.sku][a]||0)+u.units)})}),(Array.isArray(t==null?void 0:t.fos)?t.fos:[]).forEach(n=>{if(!q(n==null?void 0:n.status))return;const c=V(n);if(!c){r+=1;return}const a=B(c);_(n).forEach(u=>{!u.sku||u.units<=0||(e[u.sku]||(e[u.sku]={}),e[u.sku][a]=(e[u.sku][a]||0)+u.units)})}),{inboundBySku:e,inboundWithoutEtaCount:r}}function Pt(t){var n;const e=j(((n=t==null?void 0:t.inventory)==null?void 0:n.snapshots)||[]),r=dt(t),o=ft(t),s=Dt(t);return{baselineMonth:e,plannedSalesBySku:r,closingStockBySku:o,inboundBySku:s.inboundBySku,inboundWithoutEtaCount:s.inboundWithoutEtaCount}}function bt(t,e){const r=String(e||"").trim().toLowerCase();return r&&t.find(o=>String((o==null?void 0:o.sku)||"").trim().toLowerCase()===r)||null}function Ut(t){var u,f,y,g,l,d,D,v,I,O,x,L;const{context:e}=t;if(!e.baselineMonth)return null;const r=String(t.sku||"").trim();if(!r)return null;const o=p((u=t.product)==null?void 0:u.safetyStockDohOverride)??p((f=t.settings)==null?void 0:f.safetyStockDohDefault)??60,s=p((y=t.product)==null?void 0:y.foCoverageDohOverride)??p((g=t.settings)==null?void 0:g.foCoverageDohDefault)??90,n=p((l=t.product)==null?void 0:l.moqOverrideUnits)??p((d=t.product)==null?void 0:d.moqUnits)??p((D=t.settings)==null?void 0:D.moqDefaultUnits)??0,c=((I=(v=e.closingStockBySku)==null?void 0:v[r])==null?void 0:I[e.baselineMonth])??0,a=W({sku:r,baselineMonth:e.baselineMonth,stock0:c,forecastByMonth:((O=e.plannedSalesBySku)==null?void 0:O[r])||{},inboundByMonth:((x=e.inboundBySku)==null?void 0:x[r])||{},horizonMonths:Number(t.horizonMonths||12)});return Y({sku:r,baselineMonth:e.baselineMonth,projection:a,plannedSalesBySku:e.plannedSalesBySku,safetyStockDays:o,coverageDays:s,leadTimeDays:Number(t.leadTimeDays||0),cnyPeriod:(L=t.settings)==null?void 0:L.cny,inboundWithoutEtaCount:e.inboundWithoutEtaCount,moqUnits:n,requiredArrivalMonth:t.requiredArrivalMonth})}export{w as F,mt as I,K as P,yt as T,pt as a,Pt as b,Ut as c,ot as d,it as e,b as f,Tt as g,at as h,ht as i,H as j,P as k,At as l,Rt as m,z as n,nt as o,Nt as p,vt as q,bt as r,St as s,st as t,T as u,Et as v,Mt as w};
