import{O as d}from"./index-Q77JbDRq.js";const S=[{value:"NEXT_6",label:"Nächste 6 Monate",count:6},{value:"NEXT_12",label:"Nächste 12 Monate",count:12},{value:"NEXT_24",label:"Nächste 24 Monate",count:24},{value:"ALL",label:"Alles",count:null}];function g(){const n=new Date;return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,"0")}`}function N(n){if(!/^\d{4}-\d{2}$/.test(n||""))return null;const[r,o]=n.split("-").map(Number);return r*12+(o-1)}function O(n,r){if(!n||!r)return[];const o=N(n),u=N(r);if(o==null||u==null)return[];if(u<o)return[];const s=[];for(let i=o;i<=u;i+=1){const c=Math.floor(i/12),e=i%12+1;s.push(`${c}-${String(e).padStart(2,"0")}`)}return s}function y(n,r,o,u=S){if(!Array.isArray(n)||!n.length)return[];const s=n.slice().sort();if(r==="ALL")return s;const i=u.find(t=>t.value===r),c=i&&Number.isFinite(i.count)?i.count:0;if(!c)return s;const e=s.findIndex(t=>t>=o);return e===-1?[]:r==="NEXT_6"&&e>0?s.slice(e-1,e+c):s.slice(e,e+c)}const A={A:.8,B:.95};function C(n){return String(n||"").trim().toLowerCase()}function F(n){if(!n)return!1;if(typeof n.active=="boolean")return n.active;const r=String(n.status||"").trim().toLowerCase();return r?r==="active"||r==="aktiv":!0}function I(n,r,o){var e,t,f,a,l,m,b;if(!r||!o)return null;const u=(f=(t=(e=n==null?void 0:n.forecast)==null?void 0:e.forecastManual)==null?void 0:t[r])==null?void 0:f[o],s=d(u);if(Number.isFinite(s))return s;const i=(b=(m=(l=(a=n==null?void 0:n.forecast)==null?void 0:a.forecastImport)==null?void 0:l[r])==null?void 0:m[o])==null?void 0:b.units,c=d(i);return Number.isFinite(c)?c:null}function p(n){var i,c;const r=new Set,o=e=>{/^\d{4}-\d{2}$/.test(e||"")&&r.add(e)},u=((i=n==null?void 0:n.forecast)==null?void 0:i.forecastImport)||{};Object.values(u).forEach(e=>{!e||typeof e!="object"||Object.keys(e).forEach(o)});const s=((c=n==null?void 0:n.forecast)==null?void 0:c.forecastManual)||{};return Object.values(s).forEach(e=>{!e||typeof e!="object"||Object.keys(e).forEach(o)}),Array.from(r).sort()}function x(n){const r=Array.isArray(n==null?void 0:n.products)?n.products:[],o=p(n),u=y(o,"NEXT_6",g(),S),s=new Map,i=[];r.forEach(e=>{const t=String((e==null?void 0:e.sku)||"").trim();if(!t)return;const f=C(t),a=F(e),l=d(e==null?void 0:e.avgSellingPriceGrossEUR);let m=0;a&&Number.isFinite(l)&&l>0&&u.forEach(E=>{const h=I(n,t,E);Number.isFinite(h)&&(m+=h)});const b=Number.isFinite(l)&&l>0?m*l:null,v={sku:t,active:a,vkPriceGross:Number.isFinite(l)?l:null,units6m:a?m:null,revenue6m:a?b:null,abcClass:null,includedInRanking:a&&Number.isFinite(l)&&l>0};v.includedInRanking&&i.push(v),s.set(f,v)});const c=i.reduce((e,t)=>e+(t.revenue6m||0),0);return c>0?i.slice().sort((e,t)=>(t.revenue6m||0)-(e.revenue6m||0)).reduce((e,t)=>{const f=e+(t.revenue6m||0),a=f/c;return a<=A.A?t.abcClass="A":a<=A.B?t.abcClass="B":t.abcClass="C",f},0):i.forEach(e=>{e.abcClass="C"}),{months:u,bySku:s}}export{S as D,y as a,x as b,g as c,O as g};
