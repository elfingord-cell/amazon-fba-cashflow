const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/debug-BRWo6bxH.js","assets/index-CAzQztwo.js","assets/index-CNkV-J5s.css","assets/store-BzgQ-F5B.js","assets/orderEditorFactory-3AxbAuwW.js","assets/prefill-BxMihg1A.js","assets/productCompleteness-CNODPsSo.js","assets/costing-CmZrILJ2.js","assets/dateUtils-D7NmXfd-.js","assets/shipping-9Dzo5wwm.js","assets/deepEqual-CGWqzo0t.js","assets/useDraftForm-cLNRxzoZ.js","assets/abcClassification-D8Ca84qt.js"])))=>i.map(i=>d[i]);
import{t as a,k as e,J as T,K as f,L as E,S as v,M as C,P as S,bW as K,bV as P}from"./index-CAzQztwo.js";import{b as W}from"./abcClassification-D8Ca84qt.js";import{d as _,e as F}from"./store-BzgQ-F5B.js";import{u as U,C as b}from"./workspace-xr5uOuIo.js";import{s as O}from"./index-Cs7EqDZh.js";import{S as V}from"./index-C15xyCf_.js";import"./Dropdown-CZlZd-6U.js";const{Paragraph:A,Text:r,Title:D}=T;function H(t){return String(t||"").trim().toLowerCase()}function J(t){return["pos","fos","incomings","extras","fixcosts","dividends","products"].some(n=>Array.isArray(t[n])&&t[n].length>0)}function y(t,c=2){const n=Number(t);return Number.isFinite(n)?n.toLocaleString("de-DE",{minimumFractionDigits:c,maximumFractionDigits:c}):"-"}function I(){const{state:t,loading:c,saving:n,error:k,saveWith:m}=U(),[h,M]=O.useMessage(),[o,g]=a.useState(""),[x,p]=a.useState(null),j=t,d=F(),z=_(),l=a.useMemo(()=>(Array.isArray(t.products)?t.products:[]).map(i=>String((i||{}).sku||"").trim()).filter(Boolean),[t.products]);a.useEffect(()=>{if(!l.length){g("");return}(!o||!l.includes(o))&&g(l[0])},[o,l]);const u=a.useMemo(()=>W(j),[t]),s=a.useMemo(()=>o&&u.bySku.get(H(o))||null,[u.bySku,o]);async function B(){const i=S(structuredClone(j));if(J(j)){if(!window.confirm("Daten vorhanden - ueberschreiben?"))return;p(i)}else p(null);const w=await K(()=>import("./debug-BRWo6bxH.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]));await m(()=>S(w.buildDemoState()),"v2:debug:seed"),h.success("Testdaten wurden geladen.")}async function L(){window.confirm("Wirklich alle Daten loeschen?")&&(await m(()=>P(),"v2:debug:wipe"),h.success("Alle Daten wurden zurueckgesetzt."))}async function N(){x&&(await m(()=>S(x),"v2:debug:undo"),p(null),h.success("Letzter Seed wurde rueckgaengig gemacht."))}return e.jsxs("div",{className:"v2-page",children:[M,e.jsxs(b,{className:"v2-intro-card",children:[e.jsx("div",{className:"v2-page-head",children:e.jsxs("div",{children:[e.jsx(D,{level:3,children:"Debug / Werkzeuge"}),e.jsx(A,{children:"Hilfsfunktionen zum schnellen Befuellen, Zuruecksetzen und Pruefen der ABC-Klassifizierung."})]})}),e.jsx("div",{className:"v2-toolbar",children:e.jsxs("div",{className:"v2-toolbar-row",children:[e.jsx(f,{onClick:()=>{B()},loading:n,children:"Testdaten & POs laden"}),e.jsx(f,{danger:!0,onClick:()=>{L()},loading:n,children:"Alle Daten loeschen"}),e.jsx(f,{onClick:()=>{N()},disabled:!x,loading:n,children:"Letzten Seed rueckgaengig"}),e.jsxs(E,{color:"blue",children:["Drafts (lokal): ",z]})]})}),e.jsxs(v,{direction:"vertical",size:2,style:{marginTop:12},children:[e.jsxs(r,{children:["Storage-Key: ",e.jsx("strong",{children:d.storageKey})]}),e.jsxs(r,{children:["Last Commit: ",e.jsx("strong",{children:d.lastCommitAt||"-"})]}),e.jsxs(r,{style:{maxWidth:960},children:["Last Commit Meta:"," ",e.jsx("strong",{children:d.lastCommitMeta?JSON.stringify(d.lastCommitMeta):"-"})]})]})]}),k?e.jsx(C,{type:"error",showIcon:!0,message:k}):null,c?e.jsx(C,{type:"info",showIcon:!0,message:"Workspace wird geladen..."}):null,e.jsxs(b,{children:[e.jsx(D,{level:4,children:"ABC Debug"}),e.jsx(A,{type:"secondary",children:"Kontrolle der ABC-Berechnung auf Basis Forecast der naechsten 6 Monate."}),e.jsxs(v,{wrap:!0,align:"start",children:[e.jsxs("div",{children:[e.jsx(r,{children:"SKU"}),e.jsx(V,{value:o||void 0,onChange:i=>g(i),placeholder:"SKU waehlen",style:{width:280},options:l.map(i=>({label:i,value:i}))})]}),e.jsxs("div",{children:[e.jsx(r,{children:"Forecast-Monate"}),e.jsx("div",{children:u.months.length?u.months.join(", "):"-"})]})]}),e.jsxs(v,{direction:"vertical",style:{marginTop:14},children:[e.jsxs(r,{children:["VK-Preis (Brutto): ",e.jsx("strong",{children:y(s==null?void 0:s.vkPriceGross,2)})]}),e.jsxs(r,{children:["Forecast Units (6M): ",e.jsx("strong",{children:y(s==null?void 0:s.units6m,0)})]}),e.jsxs(r,{children:["Umsatz 6M: ",e.jsx("strong",{children:y(s==null?void 0:s.revenue6m,2)})]}),e.jsxs(r,{children:["ABC: ",e.jsx("strong",{children:(s==null?void 0:s.abcClass)||"-"})]}),e.jsxs(r,{children:["Aktiv: ",e.jsx("strong",{children:s!=null&&s.active?"ja":"nein"})]})]})]})]})}export{I as default};
