import{V as Fe,t as i,W as Me,X as Ne,Y as Le,K as Q,Z as Be,_ as Te,$ as De,a0 as Se,a1 as $e,a2 as We,a3 as Ke,a4 as g,k as n,J as _e,S as H,L as x,M as te,a5 as ve,O as pe,P as he}from"./index-CAzQztwo.js";import{D as re}from"./DeNumberInput-S8NAtNBo.js";import{b as Ve}from"./tableModels-DR-xwumi.js";import{f as ae}from"./months-DiLwPhVv.js";import{u as qe,C as fe}from"./workspace-xr5uOuIo.js";import{b as Ge,a as Pe,c as He,m as se,P as Ue,n as Xe,d as Ye}from"./planProducts-CfB8BW_g.js";import{F as ke}from"./Table-v8LS_Cg4.js";import{g as je,P as Ze,a as Je}from"./index-CrruayEm.js";import{S as $}from"./index-C15xyCf_.js";import{s as ie}from"./index-Cs7EqDZh.js";import"./index-Dab_0RQN.js";import"./productCompletenessV2-CJLSMhtL.js";import"./Dropdown-CZlZd-6U.js";import"./index-5SR9pC2K.js";import"./useBubbleLock-Cjjrx1CM.js";import"./index-BZ5evjDG.js";import"./Pagination-B0SkKhC9.js";const Qe=t=>{const{componentCls:a,iconCls:c,antCls:s,zIndexPopup:l,colorText:C,colorWarning:y,marginXXS:S,marginXS:u,fontSize:j,fontWeightStrong:B,colorTextHeading:M}=t;return{[a]:{zIndex:l,[`&${s}-popover`]:{fontSize:j},[`${a}-message`]:{marginBottom:u,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${a}-message-icon ${c}`]:{color:y,fontSize:j,lineHeight:1,marginInlineEnd:u},[`${a}-title`]:{fontWeight:B,color:M,"&:only-child":{fontWeight:"normal"}},[`${a}-description`]:{marginTop:S,color:C}},[`${a}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:u}}}}},en=t=>{const{zIndexPopupBase:a}=t;return{zIndexPopup:a+60}},Ee=Fe("Popconfirm",t=>Qe(t),en,{resetStyle:!1});var nn=function(t,a){var c={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&a.indexOf(s)<0&&(c[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(t);l<s.length;l++)a.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(t,s[l])&&(c[s[l]]=t[s[l]]);return c};const Oe=t=>{const{prefixCls:a,okButtonProps:c,cancelButtonProps:s,title:l,description:C,cancelText:y,okText:S,okType:u="primary",icon:j=i.createElement(Me,null),showCancel:B=!0,close:M,onConfirm:U,onCancel:T,onPopupClick:N}=t,{getPrefixCls:v}=i.useContext(Ne),[h]=Le("Popconfirm",De.Popconfirm),A=je(l),D=je(C);return i.createElement("div",{className:`${a}-inner-content`,onClick:N},i.createElement("div",{className:`${a}-message`},j&&i.createElement("span",{className:`${a}-message-icon`},j),i.createElement("div",{className:`${a}-message-text`},A&&i.createElement("div",{className:`${a}-title`},A),D&&i.createElement("div",{className:`${a}-description`},D))),i.createElement("div",{className:`${a}-buttons`},B&&i.createElement(Q,Object.assign({onClick:T,size:"small"},s),y||(h==null?void 0:h.cancelText)),i.createElement(Be,{buttonProps:Object.assign(Object.assign({size:"small"},Te(u)),c),actionFn:U,close:M,prefixCls:v("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},S||(h==null?void 0:h.okText))))},tn=t=>{const{prefixCls:a,placement:c,className:s,style:l}=t,C=nn(t,["prefixCls","placement","className","style"]),{getPrefixCls:y}=i.useContext(Ne),S=y("popconfirm",a),[u]=Ee(S);return u(i.createElement(Ze,{placement:c,className:Se(S,s),style:l,content:i.createElement(Oe,Object.assign({prefixCls:S},C))}))};var rn=function(t,a){var c={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&a.indexOf(s)<0&&(c[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,s=Object.getOwnPropertySymbols(t);l<s.length;l++)a.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(t,s[l])&&(c[s[l]]=t[s[l]]);return c};const an=i.forwardRef((t,a)=>{var c,s;const{prefixCls:l,placement:C="top",trigger:y="click",okType:S="primary",icon:u=i.createElement(Me,null),children:j,overlayClassName:B,onOpenChange:M,onVisibleChange:U,overlayStyle:T,styles:N,classNames:v}=t,h=rn(t,["prefixCls","placement","trigger","okType","icon","children","overlayClassName","onOpenChange","onVisibleChange","overlayStyle","styles","classNames"]),{getPrefixCls:A,className:D,style:X,classNames:I,styles:ee}=$e("popconfirm"),[K,E]=We(!1,{value:(c=t.open)!==null&&c!==void 0?c:t.visible,defaultValue:(s=t.defaultOpen)!==null&&s!==void 0?s:t.defaultVisible}),F=(b,P)=>{E(b,!0),U==null||U(b),M==null||M(b,P)},L=b=>{F(!1,b)},p=b=>{var P;return(P=t.onConfirm)===null||P===void 0?void 0:P.call(void 0,b)},_=b=>{var P;F(!1,b),(P=t.onCancel)===null||P===void 0||P.call(void 0,b)},le=(b,P)=>{const{disabled:e=!1}=t;e||F(b,P)},Y=A("popconfirm",l),ce=Se(Y,D,B,I.root,v==null?void 0:v.root),ue=Se(I.body,v==null?void 0:v.body),[de]=Ee(Y);return de(i.createElement(Je,Object.assign({},Ke(h,["title"]),{trigger:y,placement:C,onOpenChange:le,open:K,ref:a,classNames:{root:ce,body:ue},styles:{root:Object.assign(Object.assign(Object.assign(Object.assign({},ee.root),X),T),N==null?void 0:N.root),body:Object.assign(Object.assign({},ee.body),N==null?void 0:N.body)},content:i.createElement(Oe,Object.assign({okType:S,icon:u},t,{prefixCls:Y,close:L,onConfirm:p,onCancel:_})),"data-popover-inject":!0}),j))}),Ae=an;Ae._InternalPanelDoNotUseOrYouWillBeFired=tn;const{Paragraph:Ie,Text:W,Title:Re}=_e,we={standalone:"Standalone",variant_of_existing:"Variant of Existing",category_adjacent:"Category Adjacent"};function oe(){return new Date().toISOString()}function Ce(t){return`${t}-${Math.random().toString(36).slice(2,9)}`}function w(t){if(t==null||t==="")return null;const a=Number(t);return Number.isFinite(a)?a:null}function ze(){const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function k(t,a=0){const c=Number(t);return Number.isFinite(c)?c.toLocaleString("de-DE",{minimumFractionDigits:a,maximumFractionDigits:a}):"—"}function ge(t){const a=Ye(t||{},0);return{id:a.id||"",alias:a.alias||"",plannedSku:a.plannedSku||"",relationType:a.relationType||Ue[0],categoryId:a.categoryId||null,status:a.status||"active",baselineReferenceMonth:w(a.baselineReferenceMonth),baselineUnitsInReferenceMonth:w(a.baselineUnitsInReferenceMonth),seasonalityReferenceSku:a.seasonalityReferenceSku||"",baselineReferenceSku:a.baselineReferenceSku||"",avgSellingPriceGrossEUR:w(a.avgSellingPriceGrossEUR),launchDate:a.launchDate||ze(),rampUpWeeks:w(a.rampUpWeeks),softLaunchStartSharePct:w(a.softLaunchStartSharePct)}}function jn(){const{state:t,loading:a,saving:c,error:s,lastSavedAt:l,saveWith:C}=qe(),[y,S]=i.useState(!1),[u,j]=i.useState(null),[B,M]=i.useState(!1),[U,T]=i.useState(null),[N,v]=i.useState(""),[h]=g.useForm(),A=g.useWatch([],h),D=t,X=t.settings&&typeof t.settings=="object"?t.settings:{},I=i.useMemo(()=>Ve(X),[X.horizonMonths,X.startMonth]),ee=i.useMemo(()=>(Array.isArray(t.productCategories)?t.productCategories:[]).map(e=>({id:String(e.id||""),name:String(e.name||"Ohne Kategorie")})).filter(e=>e.id),[t.productCategories]),K=i.useMemo(()=>(Array.isArray(t.products)?t.products:[]).map(e=>{const r=e,o=String(r.sku||"").trim();if(!o)return null;const f=String(r.alias||o);return{value:o,label:`${f} · ${o}`}}).filter(Boolean),[t.products]),E=i.useMemo(()=>Ge({state:D,months:I}),[I,D]),F=i.useMemo(()=>u&&E.find(e=>String(e.id||"")===u)||null,[u,E]),L=i.useMemo(()=>U&&E.find(e=>String(e.id||"")===U)||null,[E,U]),p=i.useMemo(()=>{var r;if(!y)return null;const e=A||ge(F||void 0);return Pe({planProduct:e,forecastImport:((r=t.forecast)==null?void 0:r.forecastImport)||{},months:I,fallbackIndex:0})},[A,F,y,I,t.forecast]),_=i.useMemo(()=>{var R;if(!y)return null;const e=A||ge(F||void 0),r=String(e.baselineReferenceSku||"").trim(),o=Number(e.baselineReferenceMonth||0);if(!r||o<1||o>12)return null;const f=((R=t.forecast)==null?void 0:R.forecastImport)||{},d=He(f,r);if(!d)return null;const z=w((d.averagesByMonthNumber||{})[o]);return Number.isFinite(z)?{sku:r,baselineMonth:o,monthAverageUnits:z}:null},[A,F,y,t.forecast]);function le(){j(null),h.setFieldsValue({alias:"",plannedSku:"",relationType:"standalone",categoryId:null,status:"active",baselineReferenceMonth:new Date().getMonth()+1,baselineUnitsInReferenceMonth:null,seasonalityReferenceSku:"",baselineReferenceSku:"",avgSellingPriceGrossEUR:null,launchDate:ze(),rampUpWeeks:8,softLaunchStartSharePct:0}),S(!0)}function Y(e){j(String(e.id||"")),h.setFieldsValue(ge(e)),S(!0)}async function ce(e){await C(r=>{const o=he(r),f=Array.isArray(o.planProducts)?o.planProducts:[];return o.planProducts=f.filter(d=>String(d.id||"")!==e),o},"v2:plan-products:delete"),ie.success("Plan-Produkt entfernt.")}async function ue(e){const r=String(e.alias||"").trim();if(!r)throw new Error("Alias ist erforderlich.");if(!e.seasonalityReferenceSku)throw new Error("Bitte Referenz-SKU für Saisonalität wählen.");const o=Number(e.baselineReferenceMonth||0);if(!Number.isFinite(o)||o<1||o>12)throw new Error("Referenzmonat muss zwischen 1 und 12 liegen.");const f=Number(e.baselineUnitsInReferenceMonth||0);if(!Number.isFinite(f)||f<=0)throw new Error("Baseline Units im Referenzmonat müssen > 0 sein.");const d=Number(e.avgSellingPriceGrossEUR||0);if(!Number.isFinite(d)||d<=0)throw new Error("Bitte einen gültigen Preis (EUR) für Revenue-Berechnung pflegen.");const z=Xe(e.launchDate);if(!z)throw new Error("Launch-Datum ist erforderlich.");const R=Math.round(Number(e.rampUpWeeks||0));if(!Number.isFinite(R)||R<=0)throw new Error("Ramp-up Wochen müssen größer als 0 sein.");const O=Number(e.softLaunchStartSharePct||0);if(!Number.isFinite(O)||O<0||O>100)throw new Error("Soft-Launch Start in % muss zwischen 0 und 100 liegen.");await C(Z=>{var xe;const V=he(Z),m=Array.isArray(V.planProducts)?[...V.planProducts]:[],q=r.toLowerCase();if(m.find(J=>{const ye=J;return String(ye.alias||"").trim().toLowerCase()===q?u?String(ye.id||"")!==u:!0:!1}))throw new Error(`Alias "${r}" existiert bereits bei einem Plan-Produkt.`);const ne=u||Ce("plan"),G={id:ne,alias:r,plannedSku:String(e.plannedSku||"").trim(),relationType:String(e.relationType||"standalone"),categoryId:e.categoryId||null,status:e.status||"active",baselineReferenceMonth:o,baselineUnitsInReferenceMonth:f,seasonalityReferenceSku:String(e.seasonalityReferenceSku||"").trim(),baselineReferenceSku:String(e.baselineReferenceSku||"").trim(),avgSellingPriceGrossEUR:d,launchDate:z,rampUpWeeks:R,softLaunchStartSharePct:O,updatedAt:oe(),createdAt:u?String(((xe=m.find(J=>String(J.id||"")===u))==null?void 0:xe.createdAt)||oe()):oe()},be=m.findIndex(J=>String(J.id||"")===ne);return be>=0?m[be]=G:m.push(G),V.planProducts=m,V},u?"v2:plan-products:update":"v2:plan-products:create"),ie.success(u?"Plan-Produkt aktualisiert.":"Plan-Produkt angelegt."),S(!1),j(null),h.resetFields()}function de(e){const r=String(e.id||"").trim();if(!r)return;T(r);const o=String(e.plannedSku||"").trim();v(o),M(!0)}async function b(){const e=String(U||"").trim(),r=String(N||"").trim();if(!e)throw new Error("Plan-Produkt nicht gefunden.");if(!r)throw new Error("Bitte SKU für die Übernahme wählen.");if(!K.some(f=>f.value===r))throw new Error("Die gewählte SKU ist nicht in der Live-Produktdatenbank vorhanden.");await C(f=>{const d=he(f),z=d,R=Array.isArray(d.planProducts)?[...d.planProducts]:[],O=R.findIndex(G=>String(G.id||"")===e);if(O<0)throw new Error("Plan-Produkt wurde nicht gefunden.");const Z=z.forecast&&typeof z.forecast=="object"?z.forecast:{},V=Z.forecastImport&&typeof Z.forecastImport=="object"?Z.forecastImport:{},m=Pe({planProduct:R[O],forecastImport:V,months:I,fallbackIndex:O}),q=oe(),me={id:Ce("plan-map"),planProductId:String(m.id||e),planProductAlias:String(m.alias||""),sku:r,plannedSku:String(m.plannedSku||""),mappedAt:q,launchDate:String(m.launchDate||""),rampUpWeeks:Number(m.rampUpWeeks||0)||null,softLaunchStartSharePct:Number(m.softLaunchStartSharePct||0),baselineReferenceMonth:Number(m.baselineReferenceMonth||0)||null,baselineUnitsInReferenceMonth:Number(m.baselineUnitsInReferenceMonth||0)||null,seasonalityReferenceSku:String(m.seasonalityReferenceSku||""),months:[...m.months],planUnitsByMonth:{...m.unitsByMonth||{}},planRevenueByMonth:{...m.revenueByMonth||{}},source:"plan_product"},ne=Array.isArray(d.planProductMappings)?[...d.planProductMappings]:[];return d.planProductMappings=[...ne.filter(G=>String(G.planProductId||"")!==me.planProductId),me],R[O]={...R[O],status:"archived",plannedSku:r,mappedSku:r,mappedAt:q,archivedAt:q,updatedAt:q},d.planProducts=R,d},"v2:plan-products:takeover"),ie.success(`Plan-Produkt wurde als Live-SKU ${r} übernommen und archiviert.`),M(!1),T(null),v(""),window.location.hash=`#/v2/products?source=plan-products&sku=${encodeURIComponent(r)}`}const P=i.useMemo(()=>E.map(e=>({...e,monthPreview:I.slice(0,3).map(r=>{var o;return`${ae(r)}: ${k((o=e.unitsByMonth)==null?void 0:o[r],0)}`}).join(" · ")})),[I,E]);return n.jsxs("div",{className:"v2-page",children:[n.jsxs(fe,{className:"v2-intro-card",children:[n.jsxs("div",{className:"v2-page-head",children:[n.jsxs("div",{children:[n.jsx(Re,{level:3,children:"Neue Produkte (Plan-Produkte)"}),n.jsx(Ie,{children:"Pre-SKU Produkte mit Referenzmonat-Baseline und übernommener Saisonalität aus bestehender SKU. Monats-Units werden automatisch über den Forecast-Horizont berechnet."})]}),n.jsx(H,{children:n.jsx(Q,{type:"primary",onClick:le,children:"Plan-Produkt hinzufügen"})})]}),n.jsx("div",{className:"v2-toolbar",children:n.jsxs("div",{className:"v2-toolbar-row",children:[n.jsxs(x,{color:"blue",children:["Plan-Produkte: ",E.length]}),n.jsxs(x,{color:"green",children:["Aktiv: ",E.filter(e=>String(e.status||"")==="active").length]}),n.jsxs(x,{children:["Horizont: ",I.length," Monate"]}),c?n.jsx(x,{color:"processing",children:"Speichern..."}):null,l?n.jsxs(x,{color:"green",children:["Gespeichert: ",new Date(l).toLocaleTimeString("de-DE")]}):null]})})]}),s?n.jsx(te,{type:"error",showIcon:!0,message:s}):null,a?n.jsx(te,{type:"info",showIcon:!0,message:"Workspace wird geladen..."}):null,n.jsx(fe,{children:n.jsx(ke,{rowKey:e=>String(e.id||e.key||""),size:"small",pagination:!1,dataSource:P,columns:[{title:"Alias",dataIndex:"alias",key:"alias",render:e=>n.jsxs(H,{size:6,children:[n.jsx(x,{color:"blue",children:"Plan"}),n.jsx(W,{strong:!0,children:e||"—"})]})},{title:"Pre-SKU",dataIndex:"plannedSku",key:"plannedSku",render:e=>e||n.jsx(W,{type:"secondary",children:"ohne SKU"})},{title:"Relation",dataIndex:"relationType",key:"relationType",render:e=>we[e]||e||"—"},{title:"Baseline",key:"baseline",render:(e,r)=>n.jsxs("span",{children:[se(r.baselineReferenceMonth)," · ",k(r.baselineUnitsInReferenceMonth,0)," Units"]})},{title:"Saisonalität von",dataIndex:"seasonalityReferenceSku",key:"seasonalityReferenceSku",render:e=>e||"—"},{title:"Preis (EUR)",dataIndex:"avgSellingPriceGrossEUR",key:"avgSellingPriceGrossEUR",align:"right",render:e=>k(e,2)},{title:"Launch & Ramp",key:"launchRamp",render:(e,r)=>n.jsxs("span",{children:[String(r.launchDate||"—")," · ",k(w(r.rampUpWeeks),0),"W · Start ",k(w(r.softLaunchStartSharePct),0),"%"]})},{title:"Vorschau (Next 3)",dataIndex:"monthPreview",key:"monthPreview"},{title:"Status",dataIndex:"status",key:"status",render:(e,r)=>{if(e==="archived"){const o=String(r.mappedSku||r.plannedSku||"");return n.jsxs(H,{direction:"vertical",size:2,children:[n.jsx(x,{children:"Archiviert"}),o?n.jsxs(W,{type:"secondary",children:["Live-SKU: ",o]}):null]})}return e==="draft"?n.jsx(x,{color:"gold",children:"Draft"}):n.jsx(x,{color:"green",children:"Aktiv"})}},{title:"Aktionen",key:"actions",render:(e,r)=>n.jsxs(H,{size:6,children:[n.jsx(Q,{size:"small",onClick:()=>Y(r),children:"Bearbeiten"}),n.jsx(Q,{size:"small",type:"primary",ghost:!0,onClick:()=>de(r),disabled:String(r.status||"")==="archived",children:"Als gelauncht markieren"}),n.jsx(Ae,{title:"Plan-Produkt löschen?",onConfirm:()=>{ce(String(r.id||""))},children:n.jsx(Q,{size:"small",danger:!0,children:"Löschen"})})]})}],locale:{emptyText:"Noch keine Plan-Produkte angelegt."}})}),n.jsxs(ve,{title:u?"Plan-Produkt bearbeiten":"Plan-Produkt anlegen",rootClassName:"v2-form-modal",open:y,onCancel:()=>{S(!1),j(null),h.resetFields()},onOk:()=>{h.validateFields().then(e=>ue(e)).catch(()=>{})},width:980,children:[n.jsxs(g,{form:h,layout:"vertical",children:[n.jsxs("div",{className:"v2-form-row",children:[n.jsx(g.Item,{name:"alias",label:"Alias",rules:[{required:!0,message:"Alias ist erforderlich."}],children:n.jsx(pe,{placeholder:"z. B. Messerblock Premium"})}),n.jsx(g.Item,{name:"plannedSku",label:"Planned SKU (optional)",children:n.jsx(pe,{placeholder:"optional, falls intern bereits vergeben"})}),n.jsx(g.Item,{name:"status",label:"Status",initialValue:"active",children:n.jsx($,{options:[{value:"active",label:"Aktiv"},{value:"draft",label:"Draft"},{value:"archived",label:"Archiviert"}]})})]}),n.jsxs("div",{className:"v2-form-row",children:[n.jsx(g.Item,{name:"relationType",label:"Relation",rules:[{required:!0}],children:n.jsx($,{options:Ue.map(e=>({value:e,label:we[e]||e}))})}),n.jsx(g.Item,{name:"categoryId",label:"Kategorie",children:n.jsx($,{allowClear:!0,options:ee.map(e=>({value:e.id,label:e.name}))})}),n.jsx(g.Item,{name:"avgSellingPriceGrossEUR",label:"Preis (EUR) für Revenue",rules:[{required:!0,message:"Preis ist erforderlich."}],children:n.jsx(re,{mode:"decimal",min:0})})]}),n.jsxs("div",{className:"v2-form-row",children:[n.jsx(g.Item,{name:"baselineReferenceMonth",label:"Referenzmonat",rules:[{required:!0,message:"Referenzmonat ist erforderlich."}],children:n.jsx($,{options:Array.from({length:12},(e,r)=>({value:r+1,label:`${se(r+1)} (${r+1})`}))})}),n.jsx(g.Item,{name:"baselineUnitsInReferenceMonth",label:"Baseline Units im Referenzmonat",rules:[{required:!0,message:"Baseline Units sind erforderlich."}],children:n.jsx(re,{mode:"int",min:0})}),n.jsx(g.Item,{name:"seasonalityReferenceSku",label:"Saisonalität übernehmen von SKU",rules:[{required:!0,message:"Referenz-SKU ist erforderlich."}],children:n.jsx($,{showSearch:!0,optionFilterProp:"label",options:K})})]}),n.jsx("div",{className:"v2-form-row",children:n.jsx(g.Item,{name:"baselineReferenceSku",label:"Baseline-Referenz-SKU (optional)",children:n.jsx($,{allowClear:!0,showSearch:!0,optionFilterProp:"label",options:K})})}),n.jsxs("div",{className:"v2-form-row",children:[n.jsx(g.Item,{name:"launchDate",label:"Launch-Datum",rules:[{required:!0,message:"Launch-Datum ist erforderlich."}],children:n.jsx(pe,{type:"date"})}),n.jsx(g.Item,{name:"rampUpWeeks",label:"Ramp-up (Wochen)",rules:[{required:!0,message:"Ramp-up Wochen sind erforderlich."}],children:n.jsx(re,{mode:"int",min:1})}),n.jsx(g.Item,{name:"softLaunchStartSharePct",label:"Soft-Launch Start (%)",extra:"Startniveau am Launch-Tag. 0 = Start bei 0 %, 20 = Start bei 20 %.",children:n.jsx(re,{mode:"percent",min:0,max:100})})]})]}),n.jsxs(fe,{size:"small",children:[n.jsx(Re,{level:5,children:"Forecast-Vorschau (berechnet)"}),n.jsx(Ie,{type:"secondary",children:"Monatswerte werden aus Baseline im Referenzmonat, dem Saisonalitätsprofil der gewählten Referenz-SKU und einer taggenauen Launch-/Ramp-Aggregation berechnet."}),p!=null&&p.seasonality?n.jsxs(n.Fragment,{children:[n.jsxs(H,{wrap:!0,style:{marginBottom:8},children:[n.jsxs(x,{color:"blue",children:["Baseline: ",se(p.baselineReferenceMonth)," · ",k(p.baselineUnitsInReferenceMonth,0)," Units"]}),n.jsxs(x,{color:"green",children:["Referenz-SKU: ",p.seasonalityReferenceSku]}),n.jsxs(x,{color:"purple",children:["Launch: ",String(p.launchDate||"—")," · Ramp: ",k(w(p.rampUpWeeks),0),"W · Start: ",k(w(p.softLaunchStartSharePct),0),"%"]}),n.jsxs(x,{children:["Zeitraum: ",ae(p.seasonality.startMonth)," bis ",ae(p.seasonality.endMonth)]}),_?n.jsxs(x,{color:"purple",children:["Orientierung: ",_.sku," hat in ",se(_.baselineMonth)," im Schnitt ",k(_.monthAverageUnits,0)," Units"]}):null]}),n.jsx(ke,{size:"small",pagination:!1,rowKey:e=>String(e.month||""),dataSource:I.map(e=>{var r,o,f,d;return{month:e,baseUnits:(r=p.baseUnitsByMonth)==null?void 0:r[e],rampFactor:(o=p.rampFactorByMonth)==null?void 0:o[e],units:(f=p.unitsByMonth)==null?void 0:f[e],revenue:(d=p.revenueByMonth)==null?void 0:d[e]}}),columns:[{title:"Monat",dataIndex:"month",key:"month",render:e=>ae(e)},{title:"Base Units",dataIndex:"baseUnits",key:"baseUnits",align:"right",render:e=>k(w(e),2)},{title:"Ramp-Faktor",dataIndex:"rampFactor",key:"rampFactor",align:"right",render:e=>k(w(e),2)},{title:"Units (Plan)",dataIndex:"units",key:"units",align:"right",render:e=>k(e,0)},{title:"Revenue (Plan)",dataIndex:"revenue",key:"revenue",align:"right",render:e=>k(e,2)}]})]}):n.jsx(te,{type:"warning",showIcon:!0,message:"Saisonalitätsprofil noch nicht ableitbar",description:"Für die gewählte Referenz-SKU liegen noch keine verwertbaren Forecast-Monatswerte vor."})]})]}),n.jsx(ve,{title:"Plan-Produkt in Live-SKU übernehmen",open:B,onCancel:()=>{M(!1),T(null),v("")},onOk:()=>{b().catch(e=>{ie.error(e instanceof Error?e.message:String(e))})},children:n.jsxs(H,{direction:"vertical",style:{width:"100%"},children:[n.jsx(te,{type:"info",showIcon:!0,message:"Plan wird archiviert, Mapping bleibt für Plan-vs-Ist erhalten.",description:"Nach der Übernahme zählt im operativen Forecast/Cashflow nur noch die Live-SKU (CSV)."}),n.jsxs("div",{children:[n.jsx(W,{strong:!0,children:"Plan-Produkt: "}),n.jsx(W,{children:(L==null?void 0:L.alias)||"—"})]}),n.jsxs("div",{children:[n.jsx(W,{strong:!0,children:"Aktueller Status: "}),n.jsx(W,{children:(L==null?void 0:L.status)||"—"})]}),n.jsx($,{value:N||void 0,showSearch:!0,optionFilterProp:"label",placeholder:"Live-SKU auswählen",options:K,onChange:e=>v(String(e||""))})]})})]})}export{jn as default};
