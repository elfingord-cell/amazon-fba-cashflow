import{bB as R}from"./index-DiG4I6j0.js";import{d as v,l as b,c as f,e as S}from"./store-BTTMP6mO.js";import{o as A}from"./orderEditorFactory-Djr1FJ1g.js";import{b as O}from"./abcClassification-BPGw2KgL.js";import"./prefill-aSmcuWn6.js";import"./productCompleteness-CNGcv3R4.js";import"./dateUtils-D7NmXfd-.js";import"./useDraftForm-BJ58DtfH.js";function y(e){return String(e??"").replace(/[&<>"']/g,n=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[n])}function x(){var u;const e=R();e.settings={startMonth:"2024-10",horizonMonths:18,openingBalance:"120.000,00",fxRate:1.08,fxFeePct:"0,5",dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundEnabled:!0,vatRefundLagMonths:2,freightLagDays:14},e.incomings=[{month:"2024-10",revenueEur:"98.000,00",payoutPct:"50"},{month:"2024-11",revenueEur:"82.500,00",payoutPct:"49"},{month:"2024-12",revenueEur:"135.000,00",payoutPct:"51"},{month:"2025-01",revenueEur:"92.000,00",payoutPct:"50"},{month:"2025-02",revenueEur:"108.000,00",payoutPct:"48"},{month:"2025-03",revenueEur:"94.500,00",payoutPct:"49"},{month:"2025-04",revenueEur:"102.000,00",payoutPct:"50"},{month:"2025-05",revenueEur:"87.500,00",payoutPct:"51"},{month:"2025-06",revenueEur:"118.000,00",payoutPct:"48"},{month:"2025-07",revenueEur:"126.500,00",payoutPct:"49"},{month:"2025-08",revenueEur:"79.500,00",payoutPct:"50"},{month:"2025-09",revenueEur:"115.500,00",payoutPct:"48"},{month:"2025-10",revenueEur:"73.000,00",payoutPct:"51"}],e.extras=[{date:"2024-12-20",label:"Weihnachtsbonus",amountEur:"5.200,00"},{date:"2025-03-15",label:"Steuererstattung",amountEur:"7.500,00"},{date:"2025-05-10",label:"Marketing-Offensive",amountEur:"-6.800,00"}],e.fixcosts=[{id:"fix-steuerberatung",name:"Steuerberatung",category:"Steuerberatung",amount:"2.400,00",frequency:"monthly",intervalMonths:1,anchor:"15",startMonth:"2024-10",endMonth:"",proration:{enabled:!1,method:"none"},autoPaid:!0,notes:"Monatliches Honorar"},{id:"fix-ventory",name:"Ventory One Lizenz",category:"Lizenz",amount:"1.350,00",frequency:"monthly",intervalMonths:1,anchor:"1",startMonth:"2024-10",endMonth:"",proration:{enabled:!1,method:"none"},autoPaid:!1,notes:"Softwarelizenz"},{id:"fix-lager",name:"Lager & Logistik",category:"Miete",amount:"5.800,00",frequency:"monthly",intervalMonths:1,anchor:"LAST",startMonth:"2024-10",endMonth:"",proration:{enabled:!1,method:"none"},autoPaid:!0,notes:"Lagerhalle inkl. Nebenkosten"},{id:"fix-versicherung",name:"Betriebsversicherung",category:"Versicherung",amount:"2.400,00",frequency:"quarterly",intervalMonths:3,anchor:"15",startMonth:"2024-10",endMonth:"",proration:{enabled:!1,method:"none"},autoPaid:!1,notes:"Quartalsweise Prämie"}],e.fixcostOverrides={"fix-steuerberatung":{"2024-12":{amount:"3.800,00",note:"Jahresabschluss"}},"fix-lager":{"2025-07":{amount:"6.300,00",note:"Index-Anpassung",dueDate:"2025-07-25"}},"fix-versicherung":{"2025-04":{amount:"2.800,00",note:"Police erweitert"}}},e.products=[{id:"prod-sku-alpha",sku:"SKU-ALPHA",alias:"Premium French Press Set",supplierId:"Ningbo Trading",status:"active",tags:["Kitchen","Coffee"],template:{scope:"SKU",name:"Standard (SKU)",fields:{units:"1200",unitCostUsd:"11,80",unitExtraUsd:"0,60",extraFlatUsd:"250,00",transport:"sea",prodDays:40,transitDays:55,freightEur:"3.200,00",dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundEnabled:!0,vatRefundLagMonths:2,fxRate:"1,08",fxFeePct:"0,5",milestones:[{id:"tpl-alpha-ms1",label:"Deposit",percent:30,anchor:"ORDER_DATE",lagDays:0},{id:"tpl-alpha-ms2",label:"Production",percent:50,anchor:"PROD_DONE",lagDays:0},{id:"tpl-alpha-ms3",label:"Balance",percent:20,anchor:"ETA",lagDays:5}]}},createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"prod-sku-bravo",sku:"SKU-BRAVO",alias:"Ergonomischer Bürostuhl",supplierId:"Shenzhen Seats Co.",status:"active",tags:["Office"],template:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},{id:"prod-sku-charlie",sku:"SKU-CHARLIE",alias:"Fitness Resistance Bands Set",supplierId:"Xiamen Fitness",status:"active",tags:["Fitness"],template:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}],e.recentProducts=["sku-alpha","sku-bravo"],e.dividends=[{month:"2025-06",label:"Dividende",amountEur:"-12.500,00"},{month:"2025-06",label:"KapESt",amountEur:"-3.200,00"},{month:"2025-09",label:"Dividende",amountEur:"-15.000,00"},{month:"2025-09",label:"KapESt",amountEur:"-3.800,00"}],e.pos=[{id:"po-demo-2024-10",poNo:"24010",sku:"SKU-ALPHA",supplier:"Ningbo Trading",orderDate:"2024-10-05",goodsEur:"24.500,00",freightEur:"3.200,00",prodDays:40,transport:"sea",transitDays:55,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2024-10-ms1",label:"Deposit",percent:35,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2024-10-ms2",label:"Production",percent:25,anchor:"PROD_DONE",lagDays:0},{id:"po-demo-2024-10-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:5}]},{id:"po-demo-2024-11",poNo:"24011",sku:"SKU-ALPHA",supplier:"Ningbo Trading",orderDate:"2024-11-07",goodsEur:"23.800,00",freightEur:"2.800,00",prodDays:32,transport:"rail",transitDays:30,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2024-11-ms1",label:"Deposit",percent:30,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2024-11-ms2",label:"Production",percent:30,anchor:"PROD_DONE",lagDays:2},{id:"po-demo-2024-11-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:4}]},{id:"po-demo-2024-12",poNo:"24012",sku:"SKU-ALPHA",supplier:"Ningbo Trading",orderDate:"2024-12-03",goodsEur:"27.200,00",freightEur:"3.000,00",prodDays:28,transport:"air",transitDays:12,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2024-12-ms1",label:"Deposit",percent:40,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2024-12-ms2",label:"Inspection",percent:25,anchor:"PROD_DONE",lagDays:1},{id:"po-demo-2024-12-ms3",label:"Balance",percent:35,anchor:"ETA",lagDays:2}]},{id:"po-demo-2025-01",poNo:"25001",sku:"SKU-BRAVO",supplier:"Shenzhen Works",orderDate:"2025-01-10",goodsEur:"28.600,00",freightEur:"3.600,00",prodDays:36,transport:"sea",transitDays:50,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2025-01-ms1",label:"Deposit",percent:30,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2025-01-ms2",label:"Production",percent:30,anchor:"PROD_DONE",lagDays:0},{id:"po-demo-2025-01-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:6}]},{id:"po-demo-2025-02",poNo:"25002",sku:"SKU-BRAVO",supplier:"Shenzhen Works",orderDate:"2025-02-06",goodsEur:"26.400,00",freightEur:"3.100,00",prodDays:34,transport:"rail",transitDays:28,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2025-02-ms1",label:"Deposit",percent:35,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2025-02-ms2",label:"Production",percent:25,anchor:"PROD_DONE",lagDays:0},{id:"po-demo-2025-02-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:4}]},{id:"po-demo-2025-03",poNo:"25003",sku:"SKU-BRAVO",supplier:"Shenzhen Works",orderDate:"2025-03-04",goodsEur:"29.100,00",freightEur:"3.300,00",prodDays:33,transport:"sea",transitDays:54,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2025-03-ms1",label:"Deposit",percent:30,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2025-03-ms2",label:"Production",percent:30,anchor:"PROD_DONE",lagDays:3},{id:"po-demo-2025-03-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:5}]},{id:"po-demo-2025-04",poNo:"25004",sku:"SKU-CHARLIE",supplier:"Ningbo Trading",orderDate:"2025-04-08",goodsEur:"30.500,00",freightEur:"3.500,00",prodDays:31,transport:"rail",transitDays:29,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2025-04-ms1",label:"Deposit",percent:32,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2025-04-ms2",label:"Production",percent:28,anchor:"PROD_DONE",lagDays:2},{id:"po-demo-2025-04-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:3}]},{id:"po-demo-2025-05",poNo:"25005",sku:"SKU-CHARLIE",supplier:"Ningbo Trading",orderDate:"2025-05-09",goodsEur:"27.900,00",freightEur:"3.000,00",prodDays:29,transport:"air",transitDays:13,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2025-05-ms1",label:"Deposit",percent:38,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2025-05-ms2",label:"Production",percent:22,anchor:"PROD_DONE",lagDays:1},{id:"po-demo-2025-05-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:2}]},{id:"po-demo-2025-06",poNo:"25006",sku:"SKU-CHARLIE",supplier:"Ningbo Trading",orderDate:"2025-06-06",goodsEur:"31.200,00",freightEur:"3.400,00",prodDays:35,transport:"sea",transitDays:56,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2025-06-ms1",label:"Deposit",percent:34,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2025-06-ms2",label:"Production",percent:26,anchor:"PROD_DONE",lagDays:3},{id:"po-demo-2025-06-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:5}]},{id:"po-demo-2025-07",poNo:"25007",sku:"SKU-DELTA",supplier:"Shenzhen Works",orderDate:"2025-07-04",goodsEur:"28.800,00",freightEur:"2.900,00",prodDays:30,transport:"rail",transitDays:27,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2025-07-ms1",label:"Deposit",percent:36,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2025-07-ms2",label:"Inspection",percent:24,anchor:"PROD_DONE",lagDays:2},{id:"po-demo-2025-07-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:3}]},{id:"po-demo-2025-08",poNo:"25008",sku:"SKU-DELTA",supplier:"Shenzhen Works",orderDate:"2025-08-05",goodsEur:"26.700,00",freightEur:"2.700,00",prodDays:28,transport:"air",transitDays:11,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2025-08-ms1",label:"Deposit",percent:37,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2025-08-ms2",label:"Production",percent:23,anchor:"PROD_DONE",lagDays:1},{id:"po-demo-2025-08-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:1}]},{id:"po-demo-2025-09",poNo:"25009",sku:"SKU-DELTA",supplier:"Shenzhen Works",orderDate:"2025-09-09",goodsEur:"29.400,00",freightEur:"3.100,00",prodDays:32,transport:"sea",transitDays:57,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2025-09-ms1",label:"Deposit",percent:34,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2025-09-ms2",label:"Production",percent:26,anchor:"PROD_DONE",lagDays:3},{id:"po-demo-2025-09-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:4}]},{id:"po-demo-2025-10",poNo:"25010",sku:"SKU-DELTA",supplier:"Shenzhen Works",orderDate:"2025-10-06",goodsEur:"27.500,00",freightEur:"2.800,00",prodDays:29,transport:"rail",transitDays:28,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"po-demo-2025-10-ms1",label:"Deposit",percent:33,anchor:"ORDER_DATE",lagDays:0},{id:"po-demo-2025-10-ms2",label:"Production",percent:27,anchor:"PROD_DONE",lagDays:2},{id:"po-demo-2025-10-ms3",label:"Balance",percent:40,anchor:"ETA",lagDays:5}]}],e.fos=[{id:"fo-demo-2025-09",foNo:"26002",sku:"SKU-FOXTROT",supplier:"Ningbo Trading",orderDate:"2025-09-01",goodsEur:"33.000,00",freightEur:"3.200,00",prodDays:42,transport:"sea",transitDays:60,ddp:!1,dutyRatePct:"6,5",dutyIncludeFreight:!0,eustRatePct:"19",vatRefundLagMonths:2,vatRefundEnabled:!0,fxFeePct:"0,5",milestones:[{id:"fo-demo-2025-09-ms1",label:"Deposit",percent:20,anchor:"ORDER_DATE",lagDays:0},{id:"fo-demo-2025-09-ms2",label:"Production",percent:50,anchor:"PROD_DONE",lagDays:0},{id:"fo-demo-2025-09-ms3",label:"Balance",percent:30,anchor:"ETD",lagDays:0}]}];const i={fxRate:Number(((u=e.settings)==null?void 0:u.fxRate)??0)||0},{normaliseGoodsFields:s}=A;return e.pos.forEach(o=>s(o,i)),e.fos.forEach(o=>s(o,i)),e}async function K(e){const n=S(),i=v(),s=b(),u=O(s);e.innerHTML=`
    <section class="card">
      <h2>Debug / Werkzeuge</h2>
      <p class="muted">Hilfsfunktionen zum schnellen Befüllen oder Zurücksetzen des lokalen Speichers.</p>
      <div class="toolbar" style="display:flex; gap:12px; flex-wrap:wrap; margin-top:16px;">
        <button class="btn" id="seed">Testdaten &amp; POs laden</button>
        <button class="btn danger" id="wipe">Alle Daten löschen</button>
        <button class="btn secondary" id="undo" disabled>Letzten Import rückgängig</button>
      </div>
      <div id="status" class="muted" style="margin-top:12px"></div>
      <div class="muted" style="margin-top:12px">
        <div>Storage-Key: <strong>${n==null?void 0:n.storageKey}</strong></div>
        <div>Last Commit: <strong>${(n==null?void 0:n.lastCommitAt)||"—"}</strong></div>
        <div>Last Commit Meta: <strong>${n!=null&&n.lastCommitMeta?y(JSON.stringify(n.lastCommitMeta)):"—"}</strong></div>
        <div>Drafts (lokal): <strong>${i}</strong></div>
      </div>
    </section>`;const o=document.createElement("section");o.className="card",o.innerHTML=`
      <h3>ABC Debug</h3>
      <p class="muted">Kontrolle der ABC-Berechnung auf Basis der Absatzprognose (nächste 6 Monate).</p>
      <div class="row" style="gap:12px; flex-wrap:wrap; align-items:flex-end;">
        <label style="display:flex; flex-direction:column; gap:6px;">
          SKU
          <select id="abc-debug-sku"></select>
        </label>
      </div>
      <div id="abc-debug-output" class="muted" style="margin-top:12px;"></div>
    `,e.append(o);const m=e.querySelector("#status"),l=e.querySelector("#undo"),d=e.querySelector("#abc-debug-sku"),c=e.querySelector("#abc-debug-output");let r=null;function g(t){m.textContent=t,t&&setTimeout(()=>{m.textContent===t&&(m.textContent="")},2500)}function P(t){return t?["pos","fos","incomings","extras","fixcosts","dividends","products"].some(p=>Array.isArray(t[p])&&t[p].length):!1}function D(){l&&(l.disabled=!r)}function h(t,a={}){return Number.isFinite(t)?new Intl.NumberFormat("de-DE",{maximumFractionDigits:a.maximumFractionDigits??2}).format(t):"—"}function E(t){if(!c)return;if(!t){c.textContent="Keine SKU ausgewählt.";return}const a=u.bySku.get(String(t).trim().toLowerCase());if(!a){c.textContent="Keine Daten verfügbar.";return}c.innerHTML=`
      <div>VK-Preis (Brutto): <strong>${h(a.vkPriceGross)}</strong></div>
      <div>Forecast Units (6M): <strong>${h(a.units6m,{maximumFractionDigits:0})}</strong></div>
      <div>Umsatz 6M: <strong>${h(a.revenue6m)}</strong></div>
      <div>ABC: <strong>${a.abcClass||"—"}</strong></div>
    `}if(d){const t=(s.products||[]).map(a=>String((a==null?void 0:a.sku)||"").trim()).filter(Boolean);d.innerHTML=t.map(a=>`<option value="${y(a)}">${y(a)}</option>`).join(""),d.addEventListener("change",()=>E(d.value)),E(d.value)}e.querySelector("#seed").addEventListener("click",()=>{const t=b();if(P(t)){if(!window.confirm("Daten vorhanden – überschreiben?"))return;r=t}else r=null;const a=x();f(a,{source:"debug:seed",action:"seed"}),g("Testdaten wurden geladen."),D()}),e.querySelector("#wipe").addEventListener("click",()=>{const t=R();f(t,{source:"debug:wipe",action:"wipe"}),g("Alle Daten wurden zurückgesetzt.")}),l&&l.addEventListener("click",()=>{r&&(f(r,{source:"debug:undo",action:"undo"}),g("Letzter Import wurde rückgängig gemacht."),r=null,D())}),D()}export{K as render};
